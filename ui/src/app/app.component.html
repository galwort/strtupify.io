<ion-app>
  <div *ngIf="!hideMenu" class="sidebar">
    <ion-toolbar>
      <ion-buttons class="buttons">
        <a
          *ngIf="showBrandLogo"
          class="logo"
          [routerLink]="['/home']"
          aria-label="Home"
        >
          <img src="assets/favicon.svg" alt="strtupify.io" />
        </a>

        <button
          *ngIf="currentCompanyId && companyProfileEnabled"
          type="button"
          class="company-logo"
          (click)="openCompanyProfile()"
          aria-label="Company profile"
          [class.active]="showCompanyProfile"
        >
          <span class="material-symbols-outlined"> {{ companyLogo }} </span>
        </button>

        <button
          *ngIf="currentCompanyId && inboxEnabled"
          type="button"
          class="company-logo"
          (click)="openInbox()"
          aria-label="Inbox"
          [class.active]="currentModule === 'inbox' && !showCompanyProfile"
        >
          <span class="material-symbols-outlined"> mail </span>
          <span *ngIf="inboxCount > 0" class="mail-badge">{{
            inboxCount
          }}</span>
        </button>
        <button
          *ngIf="currentCompanyId && calendarEnabled"
          type="button"
          class="company-logo"
          (click)="openCalendar()"
          aria-label="Calendar"
          [class.active]="currentModule === 'calendar' && !showCompanyProfile"
        >
          <span class="material-symbols-outlined"> event </span>
        </button>
        <button
          *ngIf="currentCompanyId && workEnabled"
          type="button"
          class="company-logo"
          (click)="openWork()"
          aria-label="Kanban"
          [class.active]="currentModule === 'work' && !showCompanyProfile"
        >
          <span class="material-symbols-outlined"> task </span>
        </button>
        <button
          *ngIf="currentCompanyId && hrEnabled"
          type="button"
          class="company-logo"
          (click)="openHR()"
          aria-label="Human Resources"
          [class.active]="currentModule === 'hr' && !showCompanyProfile"
        >
          <span class="material-symbols-outlined"> group </span>
        </button>
        <button
          *ngIf="currentCompanyId && ledgerEnabled"
          type="button"
          class="company-logo"
          (click)="openLedger()"
          aria-label="General Ledger"
          [class.active]="currentModule === 'ledger' && !showCompanyProfile"
        >
          <span class="material-symbols-outlined"> account_balance </span>
        </button>

        <button
          *ngIf="showAccountButton"
          type="button"
          class="company-logo account"
          (click)="openAccount()"
          aria-label="Account"
        >
          <span class="material-symbols-outlined"> account_circle </span>
        </button>
      </ion-buttons>
    </ion-toolbar>
  </div>
  <ion-content>
    <ion-router-outlet id="main-content"></ion-router-outlet>
  </ion-content>

  <app-clock
    *ngIf="currentCompanyId && inboxEnabled && endgameStatus === 'idle'"
    [companyId]="currentCompanyId"
  ></app-clock>
  <div
    *ngIf="newEmailToast"
    class="email-toast"
    (click)="openInbox(newEmailToast?.id)"
    role="status"
    aria-live="polite"
  >
    <div class="email-toast__label">New email</div>
    <div class="email-toast__subject">{{ newEmailToast.subject }}</div>
    <div class="email-toast__meta">
      <span class="email-toast__from">{{ newEmailToast.from || "Inbox" }}</span>
      <span *ngIf="newEmailToast.preview" class="email-toast__preview">
        {{ newEmailToast.preview }}
      </span>
    </div>
  </div>
  <app-endgame-overlay
    [active]="endgameActive"
    [resetting]="endgameResetting"
    [sidebarColor]="sidebarColor"
    (reset)="handleEndgameReset()"
  ></app-endgame-overlay>
</ion-app>
