<div class="content-container">
  <div class="header">
    <div class="title">General Ledger</div>
  </div>

  <div class="filter-container">
    <label class="search">
      <input
        type="text"
        placeholder="Search description or payee"
        aria-label="Search general ledger entries"
        [value]="searchTerm"
        (input)="onSearch($any($event.target).value)"
      />
    </label>
    <ng-container *ngIf="hasActiveFilter">
      <div class="stat filtered">
        <div class="label">Filtered Total</div>
        <div class="value">{{ filteredTotal | currency: 'USD':'symbol' }}</div>
      </div>
    </ng-container>
    <div class="stat current">
      <div class="label">Current Balance</div>
      <div class="value">{{ currentBalance | currency: 'USD':'symbol' }}</div>
    </div>
  </div>

  <div class="ledger-body" *ngIf="!loading">
    <div class="ledger-table" *ngIf="filteredRows.length; else noMatches">
      <div class="thead">
        <div class="th date">Date</div>
        <div class="th desc">Description</div>
        <div class="th payee">Payee</div>
        <div class="th right amt">Amount</div>
        <div class="th right">Balance</div>
      </div>
      <div class="tbody">
        <div class="tr" *ngFor="let r of filteredRows" [class.sub]="r.sub">
          <div class="td date">{{ r.date }}</div>
          <div class="td desc">{{ r.description }}</div>
          <div class="td payee">{{ r.payee || '' }}</div>
          <div class="td right amt" [class.neg]="r.amount < 0">{{ r.amount ? (r.amount | currency: 'USD':'symbol') : '' }}</div>
          <div class="td right">{{ r.balance !== null ? (r.balance | currency: 'USD':'symbol') : '' }}</div>
        </div>
      </div>
    </div>
    <ng-template #noMatches>
      <div class="empty-state">
        <div class="title">No entries match your search</div>
        <div class="hint">Try another keyword in the description or payee.</div>
      </div>
    </ng-template>
  </div>
</div>
